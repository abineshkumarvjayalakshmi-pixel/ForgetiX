<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ForgetiX AI Assistant - NIAB</title>
  <style>
    body, html {
      margin: 0; padding: 0; height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(270deg, #8a79ff, #4d77ff, #8a79ff);
      background-size: 600% 600%;
      animation: gradientShift 20s ease infinite;
      color: #eee;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .container {
      background: rgba(0, 0, 30, 0.85);
      border-radius: 15px;
      width: 400px;
      max-width: 90vw;
      padding: 20px;
      box-shadow: 0 0 20px #4d77ffaa;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #niab-avatar {
      margin-bottom: 15px;
      width: 120px;
      height: 120px;
      filter: drop-shadow(0 0 10px #4d77ff);
    }
    #niab-avatar svg {
      width: 100%;
      height: 100%;
    }

    #chat-output {
      background: rgba(255 255 255 / 0.05);
      border-radius: 10px;
      width: 100%;
      height: 300px;
      overflow-y: auto;
      padding: 10px;
      box-sizing: border-box;
      font-size: 0.9rem;
      margin-bottom: 15px;
      color: #ccc;
    }
    .message {
      margin: 8px 0;
      padding: 8px 12px;
      border-radius: 12px;
      max-width: 80%;
      word-wrap: break-word;
    }
    .message.user {
      background: #4d77ffdd;
      align-self: flex-end;
      color: white;
    }
    .message.assistant {
      background: #8a79ffbb;
      align-self: flex-start;
      color: white;
    }

    .input-area {
      display: flex;
      width: 100%;
    }
    #user-input {
      flex-grow: 1;
      padding: 10px;
      font-size: 1rem;
      border: none;
      border-radius: 12px 0 0 12px;
      outline: none;
      background: rgba(255 255 255 / 0.1);
      color: #eee;
    }
    #user-input::placeholder {
      color: #bbb;
    }
    #send-btn {
      background: #4d77ff;
      border: none;
      padding: 0 20px;
      font-size: 1rem;
      color: white;
      cursor: pointer;
      border-radius: 0 12px 12px 0;
      transition: background-color 0.3s ease;
    }
    #send-btn:hover {
      background: #8a79ff;
    }
  </style>
</head>
<body>

  <main class="container" role="main" aria-label="NIAB AI Assistant chat interface">
    <div id="niab-avatar" aria-label="NIAB AI avatar" role="img" title="NIAB AI Assistant">
      <svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="60" cy="60" r="55" stroke="url(#grad)" stroke-width="2" fill="transparent" />
        <ellipse cx="40" cy="55" rx="8" ry="5" stroke="url(#grad)" stroke-width="2" fill="transparent" />
        <ellipse cx="80" cy="55" rx="8" ry="5" stroke="url(#grad)" stroke-width="2" fill="transparent" />
        <line x1="60" y1="60" x2="60" y2="75" stroke="url(#grad)" stroke-width="2" />
        <path id="mouth" d="M45 85 Q60 95 75 85" stroke="url(#grad)" stroke-width="2" fill="transparent" />
        <defs>
          <linearGradient id="grad" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#8a79ff"/>
            <stop offset="100%" stop-color="#4d77ff"/>
          </linearGradient>
        </defs>
      </svg>
    </div>

    <div id="chat-output" aria-live="polite" aria-label="Chat messages"></div>

    <div class="input-area">
      <input type="text" id="user-input" placeholder="Type your message here..." aria-label="User input" autocomplete="off" />
      <button id="send-btn" aria-label="Send message">Send</button>
    </div>
  </main>

  <script>
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const chatOutput = document.getElementById('chat-output');

    // Append messages to chat window
    function appendMessage(sender, message) {
      const messageElem = document.createElement('div');
      messageElem.classList.add('message', sender);
      messageElem.textContent = message;
      chatOutput.appendChild(messageElem);
      chatOutput.scrollTop = chatOutput.scrollHeight;
    }

    // Text-to-Speech function for NIAB replies
    function speak(text) {
      if (!window.speechSynthesis) return;
      if (speechSynthesis.speaking) speechSynthesis.cancel();

      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.pitch = 1;
      utterance.rate = 1;
      utterance.volume = 1;

      speechSynthesis.speak(utterance);
    }

    // Fetch AI response from OpenAI API
    async function getResponse(message) {
      const OPENAI_API_KEY = "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"; // <<< Replace with your key

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${sk-...PaEA}`
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [
              { role: "system", content: "You are NIAB, an AI assistant." },
              { role: "user", content: message }
            ],
            max_tokens: 150,
            temperature: 0.7
          })
        });

        const data = await response.json();
        if (data.choices && data.choices.length > 0) {
          return data.choices[0].message.content.trim();
        } else {
          return "Sorry, I didn't get that. Can you try again?";
        }
      } catch (error) {
        console.error("OpenAI API error:", error);
        return "Sorry, I couldn't process your request at the moment.";
      }
    }

    // Handle sending message and getting AI reply
    async function sendMessage() {
      const text = userInput.value.trim();
      if (!text) return;

      appendMessage('user', `You: ${text}`);
      userInput.value = '';
      userInput.disabled = true;
      sendBtn.disabled = true;

      const response = await getResponse(text);

      appendMessage('assistant', `niab: ${response}`);
      speak(response);

      userInput.disabled = false;
      sendBtn.disabled = false;
      userInput.focus();
    }

    // Event listeners
    sendBtn.addEventListener('click', sendMessage);
    userInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        sendMessage();
      }
    });
  </script>

</body>
</html>
